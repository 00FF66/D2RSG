\section{Формат файла шаблона}
Шаблоном считается любой корректный файл на языке \href{https://www.lua.org/}{Lua} в котором присутствует таблица \texttt{template} с параметрами для игрока, а также полем-функцией \texttt{getContents}, которая принимает список рас и размер сценария. Функция \texttt{getContents} должна вернуть таблицу с содержимым шаблона, его контентом. Поле \texttt{zones} в возвращаемой таблице содержит список зон и их объектов, а поле \texttt{connections} определяет связи (проходы) между зонами и опциональную охрану.

\subsection{Параметры видимые игроку}
Для удобства игрока шаблон определяет несколько параметров которые могут быть изменены пользователем по своему желанию перед генерацией сценария. Такие параметры как \texttt{name} и \texttt{description} не изменяемы и служат лишь для описания шаблона, а также подсказок игроку о возможном содержимом.

\subsubsection{Параметры шаблона}
\begin{itemize}
\item \texttt{name} - название шаблона
\item \texttt{description} - описание шаблона
\item \texttt{minSize} - минимальный размер сценария какой может быть создан этим шаблоном. 48 по умолчанию, максимум 144
\item \texttt{maxSize} - максимальный размер сценария какой может быть создан этим шаблоном. 48 по умолчанию, максимум 144
\item \texttt{maxPlayers} - количество игроков (рас) в сценарии. 1 по умолчанию, максимум 4
\item \texttt{startingGold} - количество бонусного золота для каждого игрока. 0 по умолчанию, максимум 9999
\item \texttt{startingNativeMana} - количество бонусной родной маны для каждого игрока. 0 по умолчанию, максимум 9999
\item \texttt{roads} - процент тайлов проходов которые станут дорогами дающими бонус передвижения. Диапазон \texttt{[0 : 100]}, 100 по умолчанию
\item \texttt{forest} - процент неиспользованных тайлов которые станут лесом. Диапазон \texttt{[0 : 100]}, 0 по умолчанию

\item \texttt{forbiddenUnits} - список идентификаторов юнитов запрещенных для генерации на шаблоне.
Идентификаторы юнитов можно найти в \texttt{GUnits.dbf} или программе
\href{https://drive.google.com/file/d/1hI7OYhoQbeizglwZwY8UuWSSr6Q1i6WO/view}{Disciples2Info}.
Запрещенных юнитов можно добавить в \hyperref[mercenary]{\selectlanguage{Russian}лагеря наемников} явно указав их в списке обязательных.

\item \texttt{forbiddenItems} - список идентификаторов предметов запрещенных для генерации на шаблоне.
Идентификаторы вещей можно найти в \texttt{GItems.dbf}.
Запрещенные предметы можно добавить в \hyperref[loot]{\selectlanguage{Russian}награды} явно указав их в списке обязательных предметов.

\item \texttt{forbiddenSpells} - список идентификаторов заклинаний запрещенных для генерации в \hyperref[mage]{\selectlanguage{Russian}Башнях магов} на шаблоне.
Идентификаторы заклинаний можно найти в \texttt{GSpells.dbf}.
Запрещенные заклинания можно добавить в \hyperref[mage]{\selectlanguage{Russian}Башни магов} явно указав их в списке обязательных заклинаний.

\item \texttt{customParameters} - список с описанием дополнительных параметров шаблона. См. \hyperref[customParameters]{\selectlanguage{Russian}Дополнительные параметры шаблона}.

\item \texttt{iterations} - количество итераций по перестановке зон при генерации. Значительно улучшает генерацию зон, но увеличивает время генерации. Диапазон [0:1000000], 0 по умолчанию (значение берется из файла generatorSettings.lua). Рекомендуемое значение 5000-10000.
\end{itemize}

\subsection{Описание содержимого}
\label{contentsTable}
Для удобства игроков и авторов шаблонов содержимое шаблона может зависеть от настроек игрока. Основными параметрами являются список рас и размер сценария.
Так же передается список выбранных значений для дополнительных параметров.
Список рас позволит контролировать субрасы отрядов, награды и тип рудников, а размер сценария даст возможность масштабировать количество объектов и отрядов.
Таким образом одним шаблоном можно описать правила генерации чтобы сценарии были играбельны как на размере 48, так и 144.\\
Описание содержимого шаблона создает функция \texttt{getContents}, которая принимает три аргумента:
\begin{itemize}
\item \texttt{races} - список рас, заданных игроком или выбранных случайно. См. \hyperref[raceTypes]{\selectlanguage{Russian}Расы}
\item \texttt{scenarioSize} - размер сценария, выбранный игроком перед началом генерации
\item \texttt{customParameters} - список значений, выбранных для дополнительных параметров. См. \hyperref[customParameters]{\selectlanguage{Russian}Дополнительные параметры шаблона}.
\end{itemize}
Функция должна вернуть таблицу содержимого - настройки зон, их наполнение и связи между ними. На основании содержимого генератор создает сценарий.\\
Обязательные поля таблицы:
\begin{itemize}
\item \texttt{zones} - список зон. См. \hyperref[zone]{\selectlanguage{Russian}Зона}
\item \texttt{connections} - список соединений зон. См. \hyperref[connection]{\selectlanguage{Russian}Проход}
\end{itemize}
Необязательные поля:
\begin{itemize}
\item \texttt{diplomacy} - список дипломатических отношений между расами. См. \hyperref[diplomacy]{\selectlanguage{Russian}Дипломатия}
\end{itemize}

\subsection{Пример}
Ниже показан пример простейшего шаблона который создаст пустой сценарий с одной зоной, занимающей всю карту, а также одним игроком. Раса игрока зависит от выбора пользователя.
Формат описания содержимого, зон, соединений и объектов подробно рассматривается в следующей секции.
\begin{figure}[H]
\lstinputlisting{docExamples/example.lua}
\caption{\selectlanguage{Russian}Простейший шаблон}
\end{figure}